---
tags: [kb]
created: 2026-01-29
updated: 2026-01-29
status: draft
---

# 1.10-mail-headers

## Overview

Brief description of the topic.

## Details

Email header analysis is a key forensic technique for tracing email origins, detecting spoofing, and verifying authenticity, especially in phishing investigations. It reveals the email's path via "Received" headers, authentication results, and more.[mailtrap+1](https://mailtrap.io/blog/email-headers/)


## Key Headers Checklist

Focus on these fields from bottom (origin) to top (delivery) for chronological path.

| Header                 | Purpose                                 | Red Flags                                                                                                                                          |
| ---------------------- | --------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| Received               | SMTP hops with IPs/timestamps/hostnames | Forged domains, impossible timestamps, private IPs exposed [mailtrap+1](https://mailtrap.io/blog/email-headers/)                                   |
| From/To                | Displayed sender/recipients             | Mismatch with envelope sender (Return-Path) [[mailtrap](https://mailtrap.io/blog/email-headers/)]​                                                 |
| Authentication-Results | SPF/DKIM/DMARC verdicts                 | "fail" or "none" on critical domains [[scribd](https://www.scribd.com/document/975523140/Email-Header-Cheat-Sheet)]​                               |
| DKIM-Signature         | Cryptographic signature                 | Missing, invalid, or body hash mismatch [[mailtrap](https://mailtrap.io/blog/email-headers/)]​                                                     |
| SPF                    | Sender Policy Framework check           | Softfail/hardfail on sending IP [[scribd](https://www.scribd.com/document/975523140/Email-Header-Cheat-Sheet)]​                                    |
| X-Originating-IP       | Client IP (some servers)                | Suspicious geolocation or proxy [[mailtrap](https://mailtrap.io/blog/email-headers/)]​                                                             |
| Message-ID             | Unique email fingerprint                | Reused or malformed IDs [[linkedin](https://www.linkedin.com/posts/yildizokan_phishing-email-analysis-toolkit-activity-7416102513428656128-7KX1)]​ |
| Subject/Date           | Basic metadata                          | Date far off current time (±24h suspicious) [[mailtrap](https://mailtrap.io/blog/email-headers/)]​                                                 |

## Analysis Steps

Follow this workflow for suspicious emails, ideal for cybersecurity honeypot logs.

1. **Trace Route**: Read bottom-up "Received" lines for originating IP (first entry). Use `whois IP` or tools like VirusTotal for owner/location.[linkedin+1](https://www.linkedin.com/posts/yildizokan_phishing-email-analysis-toolkit-activity-7416102513428656128-7KX1)
    
2. **Check Auth**: Verify SPF (sending IP authorized?), DKIM (signature valid?), DMARC (policy enforced?). Failures indicate spoofing.[[scribd](https://www.scribd.com/document/975523140/Email-Header-Cheat-Sheet)]​
    
3. **Spot Anomalies**: Mismatched From/Return-Path, unusual hops (e.g., free webmail relays), TLS failures.[[mailtrap](https://mailtrap.io/blog/email-headers/)]​
    
4. **Extract Artifacts**: URLs/IPs/domains into urlscan.io or urlscan.io; check blacklists via MX Toolbox.[[linkedin](https://www.linkedin.com/posts/yildizokan_phishing-email-analysis-toolkit-activity-7416102513428656128-7KX1)]​
    
5. **Validate with Tools**:  CyberChef (decode base64 subjects/attachments), 
    

Example: Legit header shows sequential trusted relays with pass auth; phishing often starts from bulletproof hosting with fails. Save raw headers for reports.[scribd+1](https://www.scribd.com/document/975523140/Email-Header-Cheat-Sheet)

## Common Issues

| Issue | Solution |
|-------|----------|
| Problem | Fix |

## Examples

```bash
test.sh
```

## Related Topics

- [[further reading]]

## References

- [External Link](https://example.com)

---

**Tags:** #kb #email
**Category:** 1-general-kb
