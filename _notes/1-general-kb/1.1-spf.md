---
tags:
  - kb
  - spf
  - authentication
  - dns
created: 2025-01-19
status: complete
title:
---

# 1.1 SPF (Sender Policy Framework)

## Overview

SPF specifies which mail servers are authorized to send email for your domain.

## How It Works

1. Domain publishes SPF record in DNS
2. Receiving server queries SPF record
3. Checks sender IP against authorized list
4. Accepts or rejects based on policy

## Record Syntax

```dns
v=spf1 ip4:192.0.2.0/24 include:_spf.example.com -all
```

### Components

- `v=spf1` - Version (required)
- `ip4:` - IPv4 address/range
- `ip6:` - IPv6 address/range
- `include:` - Include another SPF record
- `a` - Authorize domain's A record
- `mx` - Authorize MX records
- `all` - Default action

### Qualifiers

- `+` Pass (default)
- `-` Fail (reject)
- `~` Soft fail (accept but mark)
- `?` Neutral

## Common Examples

```dns
# Basic - only MX servers
v=spf1 mx -all

# With cloud providers
v=spf1 include:_spf.google.com include:spf.protection.outlook.com -all

# Multiple IPs
v=spf1 ip4:192.0.2.0/24 ip4:198.51.100.0/24 -all
```

## Testing

```bash
# Query SPF record
dig example.com TXT | grep spf
nslookup -type=TXT example.com
```

## Common Issues

| Issue | Solution |
|-------|----------|
| Too many DNS lookups (>10) | Flatten SPF or use IP ranges |
| Multiple SPF records | Combine into single record |
| Missing record | Add TXT record to DNS |

## Best Practices

✅ Use `-all` for strict enforcement
✅ Keep DNS lookups under 10
✅ Test with `~all` first


## Related

- [[1.2-dkim|1.2 DKIM]]
- [[1.3-dmarc|1.3 DMARC]]
- [[1.15-txt-records|1.15 TXT Records]]

---

**Tags:** #spf #authentication #dns
